(self.webpackChunk=self.webpackChunk||[]).push([[692],{79692:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>ve});var i=r(2784),l=r(47933),a=r(67594),n=r(47457),t=r(82066);const c={all:["users"],list:e=>[...c.all,"list",e],details:e=>[...c.all,"details",e]};async function o({queryKey:e}){const[,,s,r,i]=e;return(await i.get(r?`/users?${r}&page=${s}&limit=${n.IV}`:`/users?page=${s}&limit=${n.IV}`)).data}async function d({queryKey:e}){const[,,s,r]=e;return(await r.get(`/users/${s}`)).data}function u({id:e}){const s=(0,a.h_)(n.pH.IAM);return(0,t.useQuery)([...c.details(e),s],d)}function m(){const{t:e}=(0,a.$G)(),s=(0,t.useQueryClient)(),r=(0,a.h_)(n.pH.IAM);return(0,t.useMutation)((e=>async function(e,s){const r=s;return(await r.post("/users",e)).data}(e,r)),{onError:()=>{(0,a.hi)(e("User create failed"),{type:"error"})},onSuccess:()=>{s.invalidateQueries(c.all),(0,a.hi)(e("User created successfully"),{type:"success"})}})}function h(e){const{t:s}=(0,a.$G)(),r=(0,t.useQueryClient)(),i=(0,a.h_)(n.pH.IAM);return(0,t.useMutation)((s=>async function(e,s,r){return(await r.put(`/users/${e}`,s)).data}(e,s,i)),{onError:()=>{(0,a.hi)(s("User update failed"),{type:"error"})},onSuccess:async()=>{r.invalidateQueries(c.all),(0,a.hi)(s("User updated successfully"),{type:"success"})}})}var p=r(52322);function x(){var e;const{can:s}=(0,i.useContext)(a.Il),{t:r}=(0,a.$G)(),d=(0,l.k6)(),[u,m]=(0,i.useState)(1),[h,x]=(0,i.useState)(""),j=(0,a.Nr)(h),g=s&&s(n.g3.IAM.CAN_CREATE_USER),v=s&&s(n.g3.IAM.CAN_DELETE_USER),{data:b,isLoading:y,isError:f}=function({page:e=1,search:s,filters:r,enabled:l=!0}){const{can:d}=(0,i.useContext)(a.Il),u=(0,a.h_)(n.pH.IAM),m=d&&d(n.g3.IAM.CAN_LIST_USERS),h=`${s?`search=${s}`:""}&${(0,n.ik)(r)}`;return(0,t.useQuery)([...c.list(e),h,u],o,{enabled:m&&l,notifyOnChangeProps:["data"]})}({page:u,search:j});return(0,i.useEffect)((()=>{m(1)}),[j]),f?((0,a.hi)(r("Error fetching entity",{entity:"users"}),{type:"error"}),null):(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsxs)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.ZT,{h2:!0,children:r("user_list")}),g&&(0,p.jsx)(a.zx,{onClick:()=>d.push("/iam/users/create"),children:r("create")})]}),children:[(0,p.jsx)("div",{className:"network-toolbar mb-20",children:(0,p.jsx)("div",{className:"network-toolbar-actions ui-flex start v-center",children:(0,p.jsx)("div",{className:"ml-5",children:(0,p.jsx)(a.Vr,{value:h,placeholder:r("Search"),onChange:e=>{x(e.target.value)}})})})}),y?(0,p.jsx)(a.Od,{parts:["table"]}):(0,p.jsxs)(a.iA,{children:[(0,p.jsx)(a.ss,{children:(0,p.jsxs)(a.SC,{children:[(0,p.jsx)(a.pj,{as:"th",children:r("Full Name")}),(0,p.jsx)(a.pj,{as:"th",children:r("Email")}),(0,p.jsx)(a.pj,{as:"th",children:r("Phone Number")}),(0,p.jsx)(a.pj,{as:"th",style:{width:50}})]})}),(0,p.jsx)(a.RM,{children:null==b||null==(e=b.payload)?void 0:e.map((e=>(0,p.jsxs)(a.SC,{children:[(0,p.jsx)(a.pj,{children:(0,p.jsx)(a.rU,{size:"medium",component:l.rU,to:`/iam/users/details/${e.id}`,children:e.name})}),(0,p.jsx)(a.pj,{children:e.email}),(0,p.jsx)(a.pj,{children:e.phone_number}),(0,p.jsx)(a.pj,{children:v&&(0,p.jsx)(a.Lt,{renderTrigger:(e,s)=>(0,p.jsx)(a.Kk,{onClick:e,ref:s,children:(0,p.jsx)(a.JO,{type:"MoreHorizontal01",size:18})}),hasArrow:!0,placement:"right",children:(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:160},children:[(0,p.jsx)(a.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>d.push(`/iam/users/details/${e.id}`),leftIcon:(0,p.jsx)(a.JO,{type:"EyeOpen",size:18}),children:r("View")}),(0,p.jsx)(a.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>d.push(`/iam/users/edit/${e.id}`),leftIcon:(0,p.jsx)(a.JO,{type:"Pen01",size:18}),children:r("Edit")})]})})})]},e.id)))})]}),b&&!((b.payload||[]).length<1)||y?(0,p.jsx)(a.tl,{className:"ui-flex end mt-20",pages:(0,n.gc)(Number(null==b?void 0:b.total)),current:u,onPageChange:e=>m(e)}):(0,p.jsx)("div",{children:(0,p.jsx)(a.xM,{})})]})})})})}var j=r(63955),g=r(30621);const v="/iam",b="/iam/users",y="/iam/roles",f="/iam/permission-groups",N={all:["roles"],list:e=>[...N.all,"list",e],details:e=>[...N.all,"details",e]};async function I({queryKey:e}){const[,,s,r,i]=e;return(await i.get(r?`/roles?${r}&page=${s}&limit=${n.IV}`:`/roles?page=${s}&limit=${n.IV}`)).data}function _({page:e=1,search:s,filters:r,enabled:l=!0}){const{can:c}=(0,i.useContext)(a.Il),o=(0,a.h_)(n.pH.IAM),d=c&&c(n.g3.IAM.CAN_LIST_ROLES),u=`${s?`search=${s}`:""}&${(0,n.ik)(r)}`;return(0,t.useQuery)([...N.list(e),u,o],I,{enabled:d&&l,notifyOnChangeProps:["data"]})}async function C({queryKey:e}){const[,,s,r]=e;return(await r.get(`/roles/${s}`)).data}function Q({id:e}){const s=(0,a.h_)(n.pH.IAM);return(0,t.useQuery)([...N.details(e),s],C)}function S(){const{t:e}=(0,a.$G)(),s=(0,t.useQueryClient)(),r=(0,a.h_)(n.pH.IAM);return(0,t.useMutation)((e=>async function(e,s){return(await s.post("/roles",e)).data}(e,r)),{onError:()=>{(0,a.hi)(e("Role create failed"),{type:"error"})},onSuccess:()=>{s.invalidateQueries(N.all),(0,a.hi)(e("Role created successfully"),{type:"success"})}})}function O(e){const{t:s}=(0,a.$G)(),r=(0,t.useQueryClient)(),i=(0,a.h_)(n.pH.IAM);return(0,t.useMutation)((s=>async function(e,s,r){return(await r.put(`/roles/${e}`,s)).data}(e,s,i)),{onError:()=>{(0,a.hi)(s("Role update failed"),{type:"error"})},onSuccess:async()=>{r.invalidateQueries(N.all),(0,a.hi)(s("Role updated successfully"),{type:"success"})}})}const Z=()=>{var e,s,r;const t=(0,l.k6)(),{t:c}=(0,a.$G)(),o=(0,a.h_)(n.pH.IAM),d=(0,l.UO)(),[m,x]=(0,i.useState)(!1),[v,b]=(0,i.useState)(!1),[y,f]=(0,i.useState)(),{register:N,handleSubmit:I,formState:{errors:C},reset:Q,watch:S}=(0,j.cI)({resolver:(0,g.X)(n.Ut),defaultValues:{}}),{mutateAsync:O,isLoading:Z,isError:w}=h(d.id),{data:A,isLoading:z}=u({id:d.id}),{data:E}=_({});(0,i.useEffect)((()=>{var e,s,r,i,l;null!=A&&null!=(e=A.payload)&&e.id&&Q({name:null==A||null==(s=A.payload)?void 0:s.name,email:null==A||null==(r=A.payload)?void 0:r.email,phone_number:null==A||null==(i=A.payload)?void 0:i.phone_number,roles:null==A||null==(l=A.payload)?void 0:l.roles.map((e=>`${e.id}`))})}),[A,E,Q]),(0,i.useEffect)((()=>{const e=S(((e,{name:s})=>{s&&b(!0)}));return()=>e.unsubscribe()}),[S]);return z?(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.Od,{className:"ml-10",parts:["header"]}),(0,p.jsxs)(a.Zb,{children:[(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]})]})]}):(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsx)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsx)(a.ZT,{h2:!0,children:c("edit_user")}),children:(0,p.jsxs)(a.X2,{children:[(0,p.jsx)(a.sg,{offset:3,size:6,children:(0,p.jsxs)("form",{onSubmit:I((async e=>{f(void 0);try{await O(e),t.push(`/iam/users/details/${d.id}`)}catch(s){f(s)}})),children:[(0,p.jsx)(a.NI,{label:`${c("name")}*`,children:(0,p.jsx)(a.II,Object.assign({placeholder:c("enter_name")},N("name"),{error:null==C||null==(e=C.name)?void 0:e.message}))}),(0,p.jsx)(a.NI,{label:`${c("email")}*`,children:(0,p.jsx)(a.II,Object.assign({placeholder:c("enter_email")},N("email"),{error:null==C||null==(s=C.email)?void 0:s.message}))}),(0,p.jsx)(a.NI,{label:c("phone_number"),children:(0,p.jsx)(a.II,Object.assign({placeholder:c("enter_phone_number")},N("phone_number"),{error:null==C||null==(r=C.phone_number)?void 0:r.message}))}),(0,p.jsx)(a.iz,{}),E&&(0,p.jsx)(a.NI,{label:"Roles",children:(0,p.jsx)(a.OU,{multiple:!0,selectProps:N("roles"),placeholder:"Select Roles",initData:E,error:null==C||null==($=C.roles)?void 0:$.message,onQuery:({page:e,filter:s})=>o.get(`/roles?page=${e}&name=${s}`)})}),(0,p.jsx)(a.iz,{vertical:30}),(0,p.jsx)("div",{className:"mb-30",children:w&&(0,p.jsx)(a.Bc,{error:(0,a.kY)(y)?y.message:""})}),(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"form-bottom-action",children:[(0,p.jsx)(a.zx,{variant:"ghost",onClick:e=>{var s;e.preventDefault(),s=`/iam/users/details/${d.id}`,v?x(!0):t.push(s)},children:c("cancel")}),(0,p.jsx)(a.zx,{type:"submit",variant:"primary",disabled:Z,children:c("save")})]})})]})}),(0,p.jsx)(a.RZ,{modal:m,setModal:x,onLeave:()=>t.push(`/iam/users/details/${d.id}`)})]})})})})});var $},w=({user:e})=>{const{t:s}=(0,a.$G)(),{can:r}=(0,i.useContext)(a.Il),t=(0,l.k6)(),c=r&&r(n.g3.IAM.CAN_UPDATE_USER);return(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsx)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.ZT,{h2:!0,children:s("General Information")}),c&&(0,p.jsx)(a.rU,{component:a.Xd,onClick:()=>t.push(`/iam/users/edit/${e.id}`),children:s("edit")})]}),children:(0,p.jsxs)(a.X2,{cols:1,children:[(0,p.jsxs)(a.sg,{className:"mt-10",children:[(0,p.jsx)(a.ZT,{size:"small",p:!0,muted:!0,className:"mb-5",children:s("full_name")}),(0,p.jsx)(a.ZT,{children:e.name})]}),(0,p.jsxs)(a.sg,{children:[(0,p.jsx)(a.ZT,{size:"small",p:!0,muted:!0,className:"mb-5",children:s("email")}),(0,p.jsx)(a.ZT,{children:e.email})]}),(null==e?void 0:e.phone_number)&&(0,p.jsxs)(a.sg,{children:[(0,p.jsx)(a.ZT,{size:"small",p:!0,muted:!0,className:"mb-5",children:s("phone_number")}),(0,p.jsx)(a.ZT,{children:e.phone_number})]}),e.roles&&e.roles.length>0&&(0,p.jsxs)(a.sg,{children:[(0,p.jsx)(a.ZT,{size:"small",p:!0,muted:!0,className:"mb-5",children:s("roles")}),(0,p.jsx)("div",{className:"ui-flex wrap",children:e.roles.map((e=>(0,p.jsx)(a.Af,{className:"mr-5 mb-5",children:e.name},e.id)))})]})]})})})})},A={all:["permission-groups"],list:e=>[...A.all,"list",e],details:e=>[...A.all,"details",e]};function z(){var e,s;const r=(0,a.h_)(n.pH.IAM),o=(0,t.useQueryClient)(),{can:d,tenant:m}=(0,i.useContext)(a.Il),{t:h}=(0,a.$G)(),x=(0,l.k6)(),j=(0,l.UO)(),{deleteResourceMeta:g,setDeleteResourceMeta:v}=(0,a.IJ)(),[b,y]=(0,i.useState)(!1),f=d&&d(n.g3.IAM.CAN_DELETE_USER),I=d&&d(n.g3.IAM.CAN_UPDATE_USER),{data:_,isLoading:C,isError:Q}=u({id:j.id});(0,i.useEffect)((()=>{y(!1)}),[g]);return C?(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.Od,{className:"ml-10",parts:["header"]}),(0,p.jsxs)(a.Zb,{children:[(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]})]})]}):Q?((0,a.hi)(h("Error fetching",{entity:"user"}),{type:"error"}),null):(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsxs)("div",{className:"w-100 ui-flex between v-center pl-30 pr-20 pt-10",children:[(0,p.jsx)(a.ZT,{h2:!0,children:null==_||null==(e=_.payload)?void 0:e.name}),(0,p.jsx)(a.Lt,{renderTrigger:(e,s)=>(0,p.jsx)(a.zx,{size:"small",variant:"ghost",ref:s,onClick:e,iconOnly:!0,children:(0,p.jsx)(a.JO,{type:"MoreHorizontal01",size:18})}),hasArrow:!0,placement:"right",children:(0,p.jsx)("div",{className:"ui-flex column network-action-dropdown",children:(0,p.jsxs)("div",{children:[I&&(0,p.jsxs)(a.zx,{className:"w-100",variant:"ghost",muted:!0,onClick:()=>(async()=>{var e,s;(await r.post("/users/init/reset/password",{clientId:m.cognito.clientId,email:null==_||null==(e=_.payload)?void 0:e.email})).data&&(0,a.hi)(h(`Password reset request sent to ${null==_||null==(s=_.payload)?void 0:s.email}`),{type:"success"})})(),children:[(0,p.jsx)(a.JO,{type:"Pen02",size:20,className:"mr-10"}),h("reset_password")]}),f&&(0,p.jsxs)(a.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>{var e,s;null!=_&&null!=(e=_.payload)&&e.id&&v({label:"user",resource:"users",id:null==_||null==(s=_.payload)?void 0:s.id})},children:[(0,p.jsx)(a.JO,{type:"Delete",size:20,className:"mr-10"}),h("delete")]})]})})}),g&&(0,p.jsx)(a.QG,{meta:g,onClose:()=>{v(void 0)},onDelete:()=>{v(void 0),(0,a.hi)("User deleted successfully",{type:"success"}),o.invalidateQueries(N.all),o.invalidateQueries(c.all),o.invalidateQueries(A.all),x.push("/iam/users/list")},api:r}),b&&(0,p.jsx)(a.u_,{visible:b,onClose:()=>{y(!1)},style:{width:360},children:(0,p.jsxs)("div",{children:[(0,p.jsx)(a.ZT,{h2:!0,className:"ui-link-danger",children:h("error")}),(0,p.jsx)(a.iz,{}),(0,p.jsx)(a.ZT,{size:"large",children:h("delete_associated_user")}),(0,p.jsx)("div",{className:"ui-flex end mt-30",children:(0,p.jsx)(a.zx,{size:"large",variant:"ghost",onClick:()=>{y(!1)},children:h("cancel")})})]})})]})})}),(null==_||null==(s=_.payload)?void 0:s.id)&&(0,p.jsx)(w,{user:null==_?void 0:_.payload})]})}function E(){var e,s,r;const{t}=(0,a.$G)(),c=(0,a.h_)(n.pH.IAM),o=(0,l.k6)(),[d,u]=(0,i.useState)(!1),[h,x]=(0,i.useState)(!1),{register:v,handleSubmit:b,formState:{errors:y},watch:f}=(0,j.cI)({resolver:(0,g.X)(n.Ut)}),[N,I]=(0,i.useState)(),{data:C}=_({}),{mutateAsync:Q,isError:S,isLoading:O}=m();(0,i.useEffect)((()=>{const e=f(((e,{name:s})=>{s&&x(!0)}));return()=>e.unsubscribe()}),[f]);return(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsxs)(a.X2,{children:[(0,p.jsx)(a.sg,{children:(0,p.jsx)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsx)("div",{children:(0,p.jsx)(a.ZT,{h2:!0,children:t("create_user")})}),children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{offset:3,size:6,children:(0,p.jsxs)("form",{onSubmit:b((async e=>{const s=Object.assign({},e,{roles:null==e?void 0:e.roles.filter((e=>"false"!==e))});try{await Q(s),o.push("/iam/users/list")}catch(r){I(r)}})),children:[(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.ZT,{h2:!0,children:t("general_information")})}),(0,p.jsx)(a.iz,{}),(0,p.jsx)(a.NI,{label:`${t("name")}*`,children:(0,p.jsx)(a.II,Object.assign({placeholder:t("enter_name")},v("name"),{error:null==y||null==(e=y.name)?void 0:e.message}))}),(0,p.jsx)(a.NI,{label:`${t("email")}*`,children:(0,p.jsx)(a.II,Object.assign({placeholder:t("enter_email")},v("email"),{error:null==y||null==(s=y.email)?void 0:s.message}))}),(0,p.jsx)(a.NI,{label:t("phone_number"),children:(0,p.jsx)(a.II,Object.assign({placeholder:t("enter_phone_number")},v("phone_number"),{error:null==y||null==(r=y.phone_number)?void 0:r.message}))}),(0,p.jsx)(a.iz,{}),C&&(0,p.jsx)(a.NI,{label:"Roles",children:(0,p.jsx)(a.OU,{multiple:!0,selectProps:v("roles"),placeholder:"Select Roles",initData:C,error:null==y||null==(Z=y.roles)?void 0:Z.message,onQuery:({page:e,filter:s})=>c.get(`/roles?page=${e}&name=${s}`)})}),(0,p.jsx)(a.iz,{vertical:30}),(0,p.jsx)("div",{className:"mb-30",children:S&&(0,p.jsx)(a.Bc,{error:(0,a.kY)(N)?N.message:""})}),(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"form-bottom-action",children:[(0,p.jsx)(a.zx,{variant:"ghost",onClick:e=>{var s;e.preventDefault(),s="/iam/users/list",h?u(!0):o.push(s)},children:t("cancel")}),(0,p.jsx)(a.zx,{type:"submit",variant:"primary",disabled:O,children:t("create")})]})})]})})})})}),(0,p.jsx)(a.RZ,{modal:d,setModal:u,onLeave:()=>o.push("/iam/users/list")})]})});var Z}const $=({entity:e=""})=>(0,p.jsx)("div",{className:"menu-no-permissions ui-flex center py-40","data-testid":"menu-no-permission",children:(0,p.jsxs)("div",{className:"ui-flex column v-center center ",children:[(0,p.jsx)(a.JO,{type:"WarningTriangle",size:30,className:"mb-10"}),(0,p.jsx)(a.ZT,{h2:!0,children:"No Permissions!"}),(0,p.jsxs)(a.ZT,{size:"small",muted:!0,className:"mt-10",children:["You have no permissions to view ",e,". Please contact you administrator!"]})]})});function k(){var e;const{can:s}=(0,i.useContext)(a.Il),{t:r}=(0,a.$G)(),t=(0,l.k6)(),[c,o]=(0,i.useState)(1),d=s&&s(n.g3.IAM.CAN_CREATE_ROLE),u=s&&s(n.g3.IAM.CAN_UPDATE_ROLE),m=s&&s(n.g3.IAM.CAN_LIST_ROLES),[h,x]=(0,i.useState)(""),j=(0,a.Nr)(h);if(!m)return(0,p.jsx)($,{entity:"Roles"});const{data:g,isLoading:v,isError:b}=_({page:c,search:j});return(0,i.useEffect)((()=>{o(1)}),[j]),b?((0,a.hi)(r("Error fetching entity",{entity:"roles"}),{type:"error"}),null):(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsxs)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.ZT,{h2:!0,children:r("role_list")}),d&&(0,p.jsx)(a.zx,{onClick:()=>t.push("/iam/roles/create"),children:r("create")})]}),children:[(0,p.jsx)("div",{className:"network-toolbar mb-20",children:(0,p.jsx)("div",{className:"network-toolbar-actions ui-flex start v-center",children:(0,p.jsx)("div",{className:"ml-5",children:(0,p.jsx)(a.Vr,{value:h,placeholder:r("Search"),onChange:e=>{x(e.target.value)}})})})}),v?(0,p.jsx)(a.Od,{parts:["table"]}):(0,p.jsxs)(a.iA,{children:[(0,p.jsx)(a.ss,{children:(0,p.jsxs)(a.SC,{children:[(0,p.jsx)(a.pj,{as:"th",children:r("Name")}),(0,p.jsx)(a.pj,{as:"th",children:r("Description")}),(0,p.jsx)(a.pj,{as:"th",style:{width:50}})]})}),(0,p.jsx)(a.RM,{children:null==g||null==(e=g.payload)?void 0:e.map((e=>(0,p.jsxs)(a.SC,{children:[(0,p.jsx)(a.pj,{children:(0,p.jsx)(a.rU,{size:"medium",component:l.rU,to:`/iam/roles/details/${e.id}`,children:e.name})}),(0,p.jsx)(a.pj,{children:e.description}),(0,p.jsx)(a.pj,{children:(0,p.jsx)(a.Lt,{renderTrigger:(e,s)=>(0,p.jsx)(a.Kk,{onClick:e,ref:s,children:(0,p.jsx)(a.JO,{type:"MoreHorizontal01",size:18})}),hasArrow:!0,placement:"right",children:(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:160},children:[(0,p.jsx)(a.zx,{className:"w-100",variant:"ghost",muted:!0,onClick:()=>t.push(`/iam/roles/details/${e.id}`),leftIcon:(0,p.jsx)(a.JO,{type:"EyeOpen",size:18}),children:r("View")}),u&&(0,p.jsx)(a.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>t.push(`/iam/roles/edit/${e.id}`),leftIcon:(0,p.jsx)(a.JO,{type:"Pen01",size:18}),children:r("Edit")})]})})})]},e.id)))})]}),g&&!((g.payload||[]).length<1)||v?(0,p.jsx)(a.tl,{className:"ui-flex end mt-20",pages:(0,n.gc)(Number(null==g?void 0:g.total)),current:c,onPageChange:e=>o(e)}):(0,p.jsx)("div",{children:(0,p.jsx)(a.xM,{})})]})})})})}var U=r(76635),L=r.n(U);async function M({queryKey:e}){const[,,s,r,i]=e;return(await i.get(r?`/permissiongroups?${r}&page=${s}&limit=${n.IV}`:`/permissiongroups?page=${s}&limit=${n.IV}`)).data}function W({page:e=1,search:s,filters:r,enabled:l=!0}){const{can:c}=(0,i.useContext)(a.Il),o=(0,a.h_)(n.pH.IAM),d=c&&c(n.g3.IAM.CAN_LIST_PERMISSION_GROUPS),u=`${s?`search=${s}`:""}&${(0,n.ik)(r)}`;return(0,t.useQuery)([...A.list(e),u,o],M,{enabled:d&&l,notifyOnChangeProps:["data"]})}async function R({queryKey:e}){const[,,s,r]=e;return(await r.get(`/permissiongroups/${s}`)).data}function G({id:e}){const s=(0,a.h_)(n.pH.IAM);return(0,t.useQuery)([...A.details(e),s],R)}function F(){const{t:e}=(0,a.$G)(),s=(0,t.useQueryClient)(),r=(0,a.h_)(n.pH.IAM);return(0,t.useMutation)((e=>async function(e,s){return(await s.post("/permissiongroups",e)).data}(e,r)),{onError:()=>{(0,a.hi)(e("Permission group create failed"),{type:"error"})},onSuccess:()=>{s.invalidateQueries(A.all),(0,a.hi)(e("Permission group created successfully"),{type:"success"})}})}function X(e){const{t:s}=(0,a.$G)(),r=(0,t.useQueryClient)(),i=(0,a.h_)(n.pH.IAM);return(0,t.useMutation)((s=>async function(e,s,r){return(await r.put(`/permissiongroups/${e}`,s)).data}(e,s,i)),{onError:()=>{(0,a.hi)(s("Permission group update failed"),{type:"error"})},onSuccess:async()=>{r.invalidateQueries(A.all),(0,a.hi)(s("Permission group updated successfully"),{type:"success"})}})}const D=()=>{var e,s;const r=(0,a.h_)(n.pH.IAM),t=(0,l.k6)(),{t:c}=(0,a.$G)(),o=(0,l.UO)(),[d,u]=(0,i.useState)(),[m,h]=(0,i.useState)(!1),[x,v]=(0,i.useState)(!1),[b,y]=(0,i.useState)(),{register:f,handleSubmit:N,formState:{errors:I},reset:_,watch:C}=(0,j.cI)({resolver:(0,g.X)(n.S0),defaultValues:{}}),{mutateAsync:S,isLoading:Z,isError:w}=O(o.id),{data:A,isLoading:z}=Q({id:o.id}),{data:E}=W({});(0,i.useEffect)((()=>{var e,s,r,i,l;null!=A&&null!=(e=A.payload)&&e.id&&(u({payload:L().uniqBy([...(null==E?void 0:E.payload)||[],...A.payload.permissiongroups],"id"),total:null==E?void 0:E.total}),_({name:null==A||null==(s=A.payload)?void 0:s.name,description:null==A||null==(r=A.payload)?void 0:r.description,permissiongroups:null==A||null==(i=A.payload)||null==(l=i.permissiongroups)?void 0:l.map((e=>`${e.id}`))}))}),[A,E,_]),(0,i.useEffect)((()=>{const e=C(((e,{name:s})=>{s&&v(!0)}));return()=>e.unsubscribe()}),[C]);return z?(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.Od,{className:"ml-10",parts:["header"]}),(0,p.jsxs)(a.Zb,{children:[(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]})]})]}):(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsx)(a.X2,{children:(0,p.jsxs)(a.sg,{children:[(0,p.jsx)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsx)(a.ZT,{h2:!0,children:c("edit_role")}),children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{offset:3,size:6,children:(0,p.jsxs)("form",{onSubmit:N((async e=>{y(void 0);try{await S(e),t.push(`/iam/roles/details/${o.id}`)}catch(s){y(s)}})),children:[(0,p.jsx)(a.NI,{label:`${c("name")}*`,children:(0,p.jsx)(a.II,Object.assign({placeholder:c("enter_name")},f("name"),{error:null==I||null==(e=I.name)?void 0:e.message}))}),(0,p.jsx)(a.NI,{label:c("description"),children:(0,p.jsx)(a.II,Object.assign({placeholder:c("enter_description")},f("description"),{error:null==I||null==(s=I.description)?void 0:s.message}))}),(0,p.jsx)(a.iz,{}),d&&(0,p.jsx)(a.NI,{label:"Permission Groups",children:(0,p.jsx)(a.OU,{multiple:!0,selectProps:f("permissiongroups"),placeholder:c("select_permission_groups"),error:null==I||null==($=I.permissiongroups)?void 0:$.message,initData:E,onQuery:({page:e})=>r.get(`/permissiongroups?page=${e}`)})}),(0,p.jsx)(a.iz,{vertical:30}),(0,p.jsx)("div",{className:"mb-30",children:w&&(0,p.jsx)(a.Bc,{error:(0,a.kY)(b)?b.message:""})}),(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"form-bottom-action",children:[(0,p.jsx)(a.zx,{variant:"ghost",onClick:e=>{var s;e.preventDefault(),s=`/iam/roles/details/${o.id}`,x?h(!0):t.push(s)},children:c("cancel")}),(0,p.jsx)(a.zx,{type:"submit",variant:"primary",disabled:Z,children:c("save")})]})})]})})})}),(0,p.jsx)(a.RZ,{modal:m,setModal:h,onLeave:()=>t.push(`/iam/roles/details/${o.id}`)})]})})});var $},T=({role:e})=>{var s;const{t:r}=(0,a.$G)(),{can:t}=(0,i.useContext)(a.Il),c=(0,l.k6)(),o=t&&t(n.g3.IAM.CAN_UPDATE_ROLE);return(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsxs)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.ZT,{h2:!0,children:r("general_information")}),o&&(0,p.jsx)(a.rU,{component:a.Xd,onClick:()=>c.push(`/iam/roles/edit/${null==e?void 0:e.id}`),children:r("edit")})]}),children:[(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"ui-flex column",children:[(0,p.jsx)(a.ZT,{size:"small",muted:!0,className:"pb-10",children:r("name")}),(0,p.jsx)(a.ZT,{children:null==e?void 0:e.name})]})}),(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"ui-flex column",children:[(0,p.jsx)(a.ZT,{size:"small",muted:!0,className:"pb-10",children:r("description")}),(0,p.jsx)(a.ZT,{children:null==e?void 0:e.description})]})}),e&&(null==(s=e.permissiongroups)?void 0:s.length)>0&&(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"ui-flex column",children:[(0,p.jsx)(a.ZT,{size:"small",muted:!0,className:"pb-10",children:r("permission_groups")}),(0,p.jsx)("div",{className:"ui-flex wrap",children:e.permissiongroups.map((e=>(0,p.jsx)(a.Af,{className:"mr-5 mb-5",children:e.name},e.id)))})]})})]})})})};T.defaultProps={role:{name:"",description:"",permissiongroups:[]}};const P=T;function V(){var e,s;const r=(0,a.h_)(n.pH.IAM),o=(0,t.useQueryClient)(),{can:d}=(0,i.useContext)(a.Il),{t:u}=(0,a.$G)(),m=(0,l.UO)(),h=(0,l.k6)(),[x,j]=(0,i.useState)(),g=d&&d(n.g3.IAM.CAN_DELETE_ROLE),{data:v,isLoading:b,isError:y}=Q({id:m.id});return b?(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.Od,{className:"ml-10",parts:["header"]}),(0,p.jsxs)(a.Zb,{children:[(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]})]})]}):y?((0,a.hi)(u("Error fetching",{entity:"role"}),{type:"error"}),null):(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsxs)("div",{className:"w-100 ui-flex between v-center pl-30 pr-20 pt-10",children:[(0,p.jsx)(a.ZT,{h2:!0,children:null==v||null==(e=v.payload)?void 0:e.name}),g&&(0,p.jsx)(a.Lt,{renderTrigger:(e,s)=>(0,p.jsx)(a.zx,{size:"small",variant:"ghost",ref:s,onClick:e,iconOnly:!0,children:(0,p.jsx)(a.JO,{type:"MoreHorizontal01",size:18})}),hasArrow:!0,placement:"right",children:(0,p.jsx)("div",{className:"ui-flex column network-action-dropdown",children:(0,p.jsx)("div",{children:(0,p.jsxs)(a.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>{var e,s;null!=v&&null!=(e=v.payload)&&e.id&&j({label:"role",resource:"roles",id:null==v||null==(s=v.payload)?void 0:s.id})},children:[(0,p.jsx)(a.JO,{type:"Delete",size:20,className:"mr-10"}),u("delete")]})})})}),x&&(0,p.jsx)(a.QG,{meta:x,onClose:()=>{j(void 0)},onDelete:()=>{j(void 0),(0,a.hi)("Role deleted successfully",{type:"success"}),o.invalidateQueries(N.all),o.invalidateQueries(c.all),o.invalidateQueries(A.all),h.push("/iam/roles/list")},api:r})]})})}),(null==v||null==(s=v.payload)?void 0:s.id)&&(0,p.jsx)(P,{role:v.payload})]})}const B=()=>{var e,s;const r=(0,a.h_)(n.pH.IAM),t=(0,l.k6)(),{t:c}=(0,a.$G)(),[o,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!1),[h,x]=(0,i.useState)(),{register:v,handleSubmit:b,formState:{errors:y},watch:f}=(0,j.cI)({resolver:(0,g.X)(n.S0),defaultValues:{}}),{data:N,isLoading:I}=W({}),{mutateAsync:_,isError:C,isLoading:Q}=S();(0,i.useEffect)((()=>{const e=f(((e,{name:s})=>{s&&m(!0)}));return()=>e.unsubscribe()}),[f]);return I?(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.Od,{className:"ml-10",parts:["header"]}),(0,p.jsxs)(a.Zb,{children:[(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]})]})]}):(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsx)(a.X2,{children:(0,p.jsxs)(a.sg,{children:[(0,p.jsx)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsx)(a.ZT,{h2:!0,children:"Create Role"}),children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{offset:3,size:6,children:(0,p.jsxs)("form",{onSubmit:b((async e=>{x(void 0);try{await _(e),t.push("/iam/roles/list")}catch(s){x(s)}})),children:[(0,p.jsx)(a.NI,{label:`${c("name")}*`,children:(0,p.jsx)(a.II,Object.assign({placeholder:c("enter_name")},v("name"),{error:null==y||null==(e=y.name)?void 0:e.message}))}),(0,p.jsx)(a.NI,{label:c("description"),children:(0,p.jsx)(a.II,Object.assign({placeholder:c("enter_description")},v("description"),{error:null==y||null==(s=y.description)?void 0:s.message}))}),(0,p.jsx)(a.iz,{}),N&&(0,p.jsx)(a.NI,{label:"Permission Groups",children:(0,p.jsx)(a.OU,{multiple:!0,selectProps:v("permissiongroups"),placeholder:c("select_permmission_group"),error:null==y||null==(O=y.permissiongroups)?void 0:O.message,initData:N,onQuery:e=>r.get(`/permissiongroups?page=${e.page}`)})}),(0,p.jsx)(a.iz,{vertical:30}),(0,p.jsx)("div",{className:"mb-30",children:C&&(0,p.jsx)(a.Bc,{error:(0,a.kY)(h)?h.message:""})}),(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"form-bottom-action",children:[(0,p.jsx)(a.zx,{variant:"ghost",onClick:e=>{var s;e.preventDefault(),s="/iam/roles/list",u?d(!0):t.push(s)},children:c("cancel")}),(0,p.jsx)(a.zx,{type:"submit",variant:"primary",disabled:Q,children:c("create")})]})})]})})})}),(0,p.jsx)(a.RZ,{modal:o,setModal:d,onLeave:()=>t.push("/iam/roles/list")})]})})});var O};function H(){var e;const{can:s}=(0,i.useContext)(a.Il),{t:r}=(0,a.$G)(),t=(0,l.k6)(),[c,o]=(0,i.useState)(1),[d,u]=(0,i.useState)(""),m=(0,a.Nr)(d),h=s&&s(n.g3.IAM.CAN_CREATE_PERMISSION_GROUP),x=s&&s(n.g3.IAM.CAN_LIST_PERMISSION_GROUPS),j=s&&s(n.g3.IAM.CAN_UPDATE_PERMISSION_GROUP);if(!x)return(0,p.jsx)($,{entity:"Permission Group"});const{data:g,isLoading:v,isError:b}=W({page:c,search:m});return(0,i.useEffect)((()=>{o(1)}),[m]),b?((0,a.hi)(r("Error fetching entity",{entity:"permission group"}),{type:"error"}),null):(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsxs)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.ZT,{h2:!0,children:r("permission_groups_list")}),h&&(0,p.jsx)(a.zx,{onClick:()=>t.push("/iam/permission-groups/create"),children:r("create")})]}),children:[(0,p.jsx)("div",{className:"network-toolbar mb-20",children:(0,p.jsx)("div",{className:"network-toolbar-actions ui-flex start v-center",children:(0,p.jsx)("div",{className:"ml-5",children:(0,p.jsx)(a.Vr,{value:d,placeholder:r("Search"),onChange:e=>{u(e.target.value)}})})})}),v?(0,p.jsx)(a.Od,{parts:["table"]}):(0,p.jsxs)(a.iA,{children:[(0,p.jsx)(a.ss,{children:(0,p.jsxs)(a.SC,{children:[(0,p.jsx)(a.pj,{as:"th",children:r("Name")}),(0,p.jsx)(a.pj,{as:"th",style:{width:50}})]})}),(0,p.jsx)(a.RM,{children:null==g||null==(e=g.payload)?void 0:e.map((e=>(0,p.jsxs)(a.SC,{children:[(0,p.jsx)(a.pj,{children:(0,p.jsx)(a.rU,{size:"medium",component:l.rU,to:`/iam/permission-groups/details/${e.id}`,children:e.name})}),(0,p.jsx)(a.pj,{children:(0,p.jsx)(a.Lt,{renderTrigger:(e,s)=>(0,p.jsx)(a.Kk,{onClick:e,ref:s,children:(0,p.jsx)(a.JO,{type:"MoreHorizontal01",size:18})}),hasArrow:!0,placement:"right",children:(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:160},children:[(0,p.jsx)(a.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>t.push(`/iam/permission-groups/details/${e.id}`),leftIcon:(0,p.jsx)(a.JO,{type:"EyeOpen",size:18}),children:r("View")}),j&&(0,p.jsx)(a.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>t.push(`/iam/permission-groups/edit/${e.id}`),leftIcon:(0,p.jsx)(a.JO,{type:"Pen01",size:18}),children:r("Edit")})]})})})]},e.id)))})]}),g&&!((g.payload||[]).length<1)||v?(0,p.jsx)(a.tl,{className:"ui-flex end mt-20",pages:(0,n.gc)(Number(null==g?void 0:g.total)),current:c,onPageChange:e=>o(e)}):(0,p.jsx)("div",{children:(0,p.jsx)(a.xM,{})})]})})})})}const J=()=>{var e;const s=(0,l.k6)(),r=(0,l.UO)(),{t}=(0,a.$G)(),c=(0,a.h_)(n.pH.IAM),[o,d]=(0,i.useState)([]),[u,m]=(0,i.useState)(!1),[h,x]=(0,i.useState)(!1),[v,b]=(0,i.useState)(),[y,f]=(0,i.useState)({}),{register:N,handleSubmit:I,formState:{errors:_},reset:C,setValue:Q,watch:S}=(0,j.cI)({resolver:(0,g.X)(n.o9),defaultValues:{}}),{data:O,isLoading:Z}=G({id:r.id});(0,i.useEffect)((()=>{(async()=>{try{var e,s,r;const i=[],l=await c.get("/apps/apps");d(l.data.payload||[]),null==O||null==(e=O.payload)||null==(s=e.permissions)||s.map((e=>{Array.isArray(i[Number(e.app_id)])?i[Number(e.app_id)].push(`${e.id}`):i[Number(e.app_id)]=[`${e.id}`]})),f((l.data.payload||[]).reduce(((e,s)=>{var r;return e[`${s.id}`]=(null==(r=i[Number(s.id)])?void 0:r.length)===s.permissions.length||!1,e}),{})),C({name:null==O||null==(r=O.payload)?void 0:r.name,apps:i})}catch(i){b(i.response.data.error)}})()}),[]);const{mutateAsync:w,isLoading:A,isError:z}=X(r.id);(0,i.useEffect)((()=>{const e=S(((e,{name:s})=>{s&&x(!0)}));return()=>e.unsubscribe()}),[S]);return Z?(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.Od,{className:"ml-10",parts:["header"]}),(0,p.jsxs)(a.Zb,{children:[(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]})]})]}):(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsx)(a.X2,{children:(0,p.jsxs)(a.sg,{children:[(0,p.jsx)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsx)(a.ZT,{h2:!0,children:t("edit_permission_groups")}),children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{offset:3,size:6,children:(0,p.jsxs)("form",{onSubmit:I((async e=>{b(void 0);try{const i={name:e.name,permissions:[].concat(...e.apps.filter((e=>e&&e.length)))};if(!i.permissions.length)return void b("You must select at least one permission");await w(i),s.push(`/iam/permission-groups/details/${r.id}`)}catch(i){b(i)}})),children:[(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.ZT,{h2:!0,children:t("general_information")})}),(0,p.jsx)(a.iz,{}),(0,p.jsx)(a.NI,{label:`${t("name")}*`,children:(0,p.jsx)(a.II,Object.assign({placeholder:t("enter_name")},N("name",{required:"Name is required"}),{error:null==_||null==(e=_.name)?void 0:e.message}))}),(0,p.jsx)(a.iz,{}),o&&(o||[]).map((e=>(0,p.jsxs)(a.NI,{label:e.name.charAt(0).toUpperCase()+e.name.slice(1),className:"mt-20",children:[(0,p.jsx)("div",{className:"mb-5",children:(0,p.jsx)(a.XZ,{value:e.name,label:"Check all",checked:y[e.id],onChange:s=>{Q(`apps[${e.id}]`,s.target.checked?e.permissions.map((e=>`${e.id}`)):[]),f(Object.assign({},y,{[e.id]:s.target.checked}))}},e.name)}),(0,p.jsx)(a.Ph,{multiple:!0,placeholder:t("select_permissions"),selectProps:N(`apps[${e.id}]`),children:e&&e.permissions.map((e=>(0,p.jsx)(a.Wx,{value:`${e.id}`,children:e.name},e.name)))})]},e.id))),(0,p.jsx)(a.iz,{vertical:30}),(0,p.jsx)("div",{className:"mb-30",children:z&&(0,p.jsx)(a.Bc,{error:(0,a.kY)(v)?v.message:""})}),(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"form-bottom-action",children:[(0,p.jsx)(a.zx,{variant:"ghost",onClick:e=>{var i;e.preventDefault(),i=`/iam/permission-groups/details/${r.id}`,h?m(!0):s.push(i)},children:t("cancel")}),(0,p.jsx)(a.zx,{type:"submit",variant:"primary",disabled:A,children:t("save")})]})})]})})})}),(0,p.jsx)(a.RZ,{modal:u,setModal:m,onLeave:()=>s.push(`/iam/permission-groups/details/${r.id}`)})]})})})};function Y(){var e,s,r;const o=(0,a.h_)(n.pH.IAM),d=(0,t.useQueryClient)(),{t:u}=(0,a.$G)(),m=(0,l.k6)(),{can:h}=(0,i.useContext)(a.Il),x=(0,l.UO)(),{deleteResourceMeta:j,setDeleteResourceMeta:g}=(0,a.IJ)(),v=h&&h(n.g3.IAM.CAN_GET_SINGLE_PERMISSION_GROUP),b=h&&h(n.g3.IAM.CAN_DELETE_PERMISSION_GROUP),{data:y,isLoading:f,isError:I}=G({id:x.id});return f?(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.Od,{className:"ml-10",parts:["header"]}),(0,p.jsxs)(a.Zb,{children:[(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]})]})]}):I?((0,a.hi)(u("Error fetching",{entity:"permission group"}),{type:"error"}),null):(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsxs)("div",{className:"w-100 ui-flex between v-center pl-30 pr-20 pt-10",children:[(0,p.jsx)(a.ZT,{h2:!0,children:null==y||null==(e=y.payload)?void 0:e.name}),b&&(0,p.jsx)(a.Lt,{renderTrigger:(e,s)=>(0,p.jsx)(a.zx,{size:"small",variant:"ghost",ref:s,onClick:e,iconOnly:!0,children:(0,p.jsx)(a.JO,{type:"MoreHorizontal01",size:18})}),hasArrow:!0,placement:"right",children:(0,p.jsx)("div",{className:"ui-flex column network-action-dropdown",children:(0,p.jsx)("div",{children:(0,p.jsxs)(a.zx,{className:"w-100",variant:"danger-ghost",muted:!0,onClick:()=>{var e;null!=y&&null!=(e=y.payload)&&e.id&&g({label:"permission group",resource:"permissiongroups",id:y.payload.id})},children:[(0,p.jsx)(a.JO,{type:"Delete",size:20,className:"mr-10"}),u("delete")]})})})}),j&&(0,p.jsx)(a.QG,{meta:j,onClose:()=>{g(void 0)},onDelete:()=>{g(void 0),(0,a.hi)("Permission Group deleted successfully",{type:"success"}),d.invalidateQueries(N.all),d.invalidateQueries(c.all),d.invalidateQueries(A.all),m.push("/iam/permission-groups/list")},api:o})]})})}),(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{children:(0,p.jsxs)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.ZT,{h2:!0,children:u("General Information")}),v&&(0,p.jsx)(a.rU,{component:a.Xd,onClick:()=>{var e;return m.push(`/iam/permission-groups/edit/${null==y||null==(e=y.payload)?void 0:e.id}`)},children:u("edit")})]}),children:[(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"ui-flex column",children:[(0,p.jsx)(a.ZT,{size:"small",muted:!0,className:"pb-10",children:u("name")}),(0,p.jsx)(a.ZT,{children:null==y||null==(s=y.payload)?void 0:s.name})]})}),(null==y?void 0:y.payload)&&((null==y?void 0:y.payload.permissions)||[]).length>0&&(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"ui-flex column",children:[(0,p.jsx)(a.ZT,{size:"small",muted:!0,className:"pb-10",children:u("permission_groups")}),(0,p.jsx)("div",{className:"ui-flex wrap",children:null==y||null==(r=y.payload.permissions)?void 0:r.map((e=>(0,p.jsx)(a.Af,{className:"mr-5 mb-5",children:e.name},e.id)))})]})})]})})})]})}const q=()=>{var e;const s=(0,a.h_)(n.pH.IAM),r=(0,l.k6)(),{t}=(0,a.$G)(),[c,o]=(0,i.useState)(!0),[d,u]=(0,i.useState)([]),[m,h]=(0,i.useState)(!1),[x,v]=(0,i.useState)(!1),[b,y]=(0,i.useState)(),[f,N]=(0,i.useState)({}),{register:I,handleSubmit:_,setValue:C,watch:Q,formState:{errors:S}}=(0,j.cI)({resolver:(0,g.X)(n.o9),defaultValues:{}});(0,i.useEffect)((()=>{o(!0);(async()=>{try{const e=(await s.get("/apps/apps")).data.payload||[];u(e),N(e.reduce(((e,s)=>(e[`${s.id}`]=!1,e)),{})),o(!1)}catch(e){y(e.response.data.error)}})()}),[]);const{mutateAsync:O,isError:Z,isLoading:w}=F();(0,i.useEffect)((()=>{const e=Q(((e,{name:s})=>{s&&v(!0)}));return()=>e.unsubscribe()}),[Q]);return c?(0,p.jsxs)(a.rj,{gutter:0,children:[(0,p.jsx)(a.Od,{className:"ml-10",parts:["header"]}),(0,p.jsxs)(a.Zb,{children:[(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]}),(0,p.jsx)(a.Od,{parts:["title"]})]})]}):(0,p.jsx)(a.rj,{gutter:0,children:(0,p.jsx)(a.X2,{children:(0,p.jsxs)(a.sg,{children:[(0,p.jsx)(a.Zb,{className:"iam-content",page:!0,header:(0,p.jsx)(a.ZT,{h2:!0,children:t("create_permission_groups")}),children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.sg,{offset:3,size:6,children:(0,p.jsxs)("form",{onSubmit:_((async e=>{y(void 0);try{const s={name:e.name,permissions:[].concat(...e.apps.filter((e=>e&&e.length))).map((e=>Number(e)))};if(!s.permissions.length)return void y("You must select at least one permission");await O(s),r.push("/iam/permission-groups/list")}catch(s){y(s.response.data.error)}})),children:[(0,p.jsx)(a.NI,{label:`${t("name")}*`,children:(0,p.jsx)(a.II,Object.assign({placeholder:t("Enter Name")},I("name"),{error:null==S||null==(e=S.name)?void 0:e.message}))}),d&&(d||[]).map((e=>(0,p.jsxs)(a.NI,{label:e.name.charAt(0).toUpperCase()+e.name.slice(1),className:"mt-20",children:[(0,p.jsx)("div",{className:"mb-5",children:(0,p.jsx)(a.XZ,{value:e.name,label:t("check_all"),checked:f[e.id],onChange:s=>{C(`apps[${e.id}]`,s.target.checked?e.permissions.map((e=>`${e.id}`)):[]),N(Object.assign({},f,{[e.id]:s.target.checked}))}},e.name)}),(0,p.jsx)(a.Ph,{multiple:!0,placeholder:t("select_permissions"),selectProps:I(`apps[${e.id}]`),error:b,children:e&&e.permissions.map((e=>(0,p.jsx)(a.Wx,{value:`${e.id}`,children:e.name},e.name)))})]},e.id))),(0,p.jsx)(a.iz,{vertical:30}),(0,p.jsx)("div",{className:"mb-30",children:Z&&(0,p.jsx)(a.Bc,{error:(0,a.kY)(b)?b.message:""})}),(0,p.jsx)(a.iz,{vertical:30}),(0,p.jsx)(a.X2,{children:(0,p.jsxs)("div",{className:"form-bottom-action",children:[(0,p.jsx)(a.zx,{variant:"ghost",onClick:e=>{var s;e.preventDefault(),s="/iam/permission-groups/list",x?h(!0):r.push(s)},children:t("cancel")}),(0,p.jsx)(a.zx,{type:"submit",variant:"primary",disabled:w,children:t("create")})]})})]})})})}),(0,p.jsx)(a.RZ,{modal:m,setModal:h,onLeave:()=>r.push("/iam/permission-groups/list")})]})})})};var K=r(46062),ee=r.n(K),se=r(44036),re=r.n(se),ie=r(96793),le=r.n(ie),ae=r(17892),ne=r.n(ae),te=r(11173),ce=r.n(te),oe=r(42464),de=r.n(oe),ue=r(57847),me=r.n(ue),he={};he.styleTagTransform=de(),he.setAttributes=ne(),he.insert=le().bind(null,"head"),he.domAPI=re(),he.insertStyleElement=ce();ee()(me(),he);me()&&me().locals&&me().locals;const pe={en:{translation:{cancel:"Cancel",save:"Save",edit:"Edit",create:"Create",view:"View",delete:"Delete",manage:"Manage",general_information:"General Information",users:"Users",roles:"Roles",permission_groups:"Permission Groups",users_roles:"Users & Roles",user_list:"User List",name:"Name",full_name:"Full Name",email:"Email",create_user:"Create User",phone_number:"Phone Number",select_roles:"Select Roles",enter_name:"Enter Name",enter_email:"Enter Email",enter_phone_number:"Enter Phone Number",edit_user:"Edit User",reset_password:"Reset password",role_list:"Role List",create_role:"Create Role",edit_role:"Edit Role",description:"Description",enter_description:"Enter Description",select_permission_groups:"Select Permission Groups",permission_groups_list:"Permission Groups List",create_permission_groups:"Create Permission Groups",edit_permission_groups:"Edit Permission Groups",network:"Network",menu:"Menu",voucher:"Voucher",check_all:"Check all",select_permissions:"Select Permissions",error:"Error",delete_associated_user:"Delete associated user"}}};(0,a.Dm)(pe);const xe=()=>(0,p.jsxs)(l.rs,{children:[(0,p.jsx)(l.AW,{exact:!0,path:"/iam/users/list",children:(0,p.jsx)(x,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/users/edit/:id",children:(0,p.jsx)(Z,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/users/create",children:(0,p.jsx)(E,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/users/details/:id",children:(0,p.jsx)(z,{})})]}),je=()=>(0,p.jsxs)(l.rs,{children:[(0,p.jsx)(l.AW,{exact:!0,path:"/iam/roles/list",children:(0,p.jsx)(k,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/roles/edit/:id",children:(0,p.jsx)(D,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/roles/details/:id",children:(0,p.jsx)(V,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/roles/create",children:(0,p.jsx)(B,{})})]}),ge=()=>(0,p.jsxs)(l.rs,{children:[(0,p.jsx)(l.AW,{exact:!0,path:"/iam/permission-groups/list",children:(0,p.jsx)(H,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/permission-groups/edit/:id",children:(0,p.jsx)(J,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/permission-groups/details/:id",children:(0,p.jsx)(Y,{})}),(0,p.jsx)(l.AW,{exact:!0,path:"/iam/permission-groups/create",children:(0,p.jsx)(q,{})})]}),ve=({history:e})=>{const{setNavigation:s}=(0,i.useContext)(a.Il);return(0,i.useEffect)((()=>{null==s||s(n.pH.IAM,[{name:"Users",path:"/iam/users/list",permission:!0},{name:"Roles",path:"/iam/roles/list",permission:!0},{name:"Permission groups",path:"/iam/permission-groups/list",permission:!0}])}),[]),(0,p.jsx)(l.F0,{history:e,children:(0,p.jsx)(l.rs,{children:(0,p.jsx)(l.AW,{children:(0,p.jsxs)(l.rs,{children:[(0,p.jsx)(l.AW,{exact:!0,path:v,children:(0,p.jsx)(l.l_,{to:"/iam/users/list"})}),(0,p.jsx)(l.AW,{path:b,children:(0,p.jsx)(xe,{})}),(0,p.jsx)(l.AW,{path:y,children:(0,p.jsx)(je,{})}),(0,p.jsx)(l.AW,{path:f,children:(0,p.jsx)(ge,{})})]})})})})}},57847:e=>{e.exports=[[e.id,".iam-container{display:flex;flex-direction:column;height:100%;width:100%}.iam-container .iam-content+.iam-content{margin-top:10px}.iam-content{width:100%;flex:1}.iam-content>.ui-row{margin-top:0}.iam-content form>.ui-form-control+.ui-form-control{margin-top:10px}.toolbar{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:20px 30px}.ui-row+.ui-row{margin-top:0}.form-bottom-action{display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.form-bottom-action>.ui-btn+.ui-btn{margin-left:10px}.iam-sidebar-wrapper .ui-btn+.ui-btn{margin-top:10px}.iam-sidebar-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px}.iam-link-no-underline{text-decoration:none !important;cursor:pointer}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0eWxlcy5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLGVBQWUsWUFBWSxDQUFDLHFCQUFxQixDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMseUNBQXlDLGVBQWUsQ0FBQyxhQUFhLFVBQVUsQ0FBQyxNQUFNLENBQUMscUJBQXFCLFlBQVksQ0FBQyxvREFBb0QsZUFBZSxDQUFDLFNBQVMsWUFBWSxDQUFDLGtCQUFrQixDQUFDLGtCQUFrQixDQUFDLDZCQUE2QixDQUFDLGlCQUFpQixDQUFDLGdCQUFnQixZQUFZLENBQUMsb0JBQW9CLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxrQkFBa0IsQ0FBQyx3QkFBd0IsQ0FBQyxvQ0FBb0MsZ0JBQWdCLENBQUMscUNBQXFDLGVBQWUsQ0FBQyxvQkFBb0IsWUFBWSxDQUFDLGtCQUFrQixDQUFDLDZCQUE2QixDQUFDLGtCQUFrQixDQUFDLHVCQUF1QiwrQkFBK0IsQ0FBQyxjQUFjIiwiZmlsZSI6InN0eWxlcy5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmlhbS1jb250YWluZXJ7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlfS5pYW0tY29udGFpbmVyIC5pYW0tY29udGVudCsuaWFtLWNvbnRlbnR7bWFyZ2luLXRvcDoxMHB4fS5pYW0tY29udGVudHt3aWR0aDoxMDAlO2ZsZXg6MX0uaWFtLWNvbnRlbnQ+LnVpLXJvd3ttYXJnaW4tdG9wOjB9LmlhbS1jb250ZW50IGZvcm0+LnVpLWZvcm0tY29udHJvbCsudWktZm9ybS1jb250cm9se21hcmdpbi10b3A6MTBweH0udG9vbGJhcntkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246cm93O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjtwYWRkaW5nOjIwcHggMzBweH0udWktcm93Ky51aS1yb3d7bWFyZ2luLXRvcDowfS5mb3JtLWJvdHRvbS1hY3Rpb257ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kfS5mb3JtLWJvdHRvbS1hY3Rpb24+LnVpLWJ0bisudWktYnRue21hcmdpbi1sZWZ0OjEwcHh9LmlhbS1zaWRlYmFyLXdyYXBwZXIgLnVpLWJ0bisudWktYnRue21hcmdpbi10b3A6MTBweH0uaWFtLXNpZGViYXItaGVhZGVye2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47bWFyZ2luLWJvdHRvbToxNXB4fS5pYW0tbGluay1uby11bmRlcmxpbmV7dGV4dC1kZWNvcmF0aW9uOm5vbmUgIWltcG9ydGFudDtjdXJzb3I6cG9pbnRlcn0iXX0= */","",""]]}}]);